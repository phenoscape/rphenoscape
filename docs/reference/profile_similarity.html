<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Semantic similarity between profiles — profile_similarity • rphenoscape</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Semantic similarity between profiles — profile_similarity" />
<meta property="og:description" content="Calculates the semantic similarity between profiles (groups) of terms.
bestPairs aggregates pairwise scores by &quot;best pairs&quot; between two profiles.
That is, for profiles P1 and P2 with terms T1[i] (i = 1,...n) and T2[j]
(j = 1,...,m), respectively, for S(P1, P2) bestPairs will determine for
each i the score s(T1[i], T2[j]) that is &quot;best&quot; (see parameter best),
followed by aggregating the resulting n best-pair scores to a single value
(see parameter aggregate). The resulting scores are necessarily asymmetric,
i.e., S(P1, P2) != S(P2, P1) for P1 != P2.
reduce.ignoringDiag is a convenience function for aggregating pairwise
similarity scores such that the diagonal of the pair-wise similarity matrix
is ignored. This may be desirable, for example, when average with-in group
similarity should exclude the similarity of terms to themselves." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/phenoscape/rphenoscape/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Semantic similarity between profiles</h1>
    <small class="dont-index">Source: <a href='https://github.com/phenoscape/rphenoscape/blob/master/R/profile-semsim.R'><code>R/profile-semsim.R</code></a></small>
    <div class="hidden name"><code>profile_similarity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the semantic similarity between profiles (groups) of terms.</p>
<p><code>bestPairs</code> aggregates pairwise scores by "best pairs" between two profiles.
That is, for profiles P1 and P2 with terms T1[i] (i = 1,...n) and T2[j]
(j = 1,...,m), respectively, for S(P1, P2) <code>bestPairs</code> will determine for
each i the score s(T1[i], T2[j]) that is "best" (see parameter <code>best</code>),
followed by aggregating the resulting n best-pair scores to a single value
(see parameter <code>aggregate</code>). The resulting scores are necessarily asymmetric,
i.e., S(P1, P2) != S(P2, P1) for P1 != P2.</p>
<p><code>reduce.ignoringDiag</code> is a convenience function for aggregating pairwise
similarity scores such that the diagonal of the pair-wise similarity matrix
is ignored. This may be desirable, for example, when average with-in group
similarity should exclude the similarity of terms to themselves.</p>
    </div>

    <pre class="usage"><span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>pairwise</span>, <span class='va'>subsumer_mat</span>, <span class='va'>...</span>, <span class='va'>f</span>, reduce <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>

<span class='fu'>bestPairs</span><span class='op'>(</span><span class='va'>X</span>, best <span class='op'>=</span> <span class='va'>max</span>, aggregate <span class='op'>=</span> <span class='va'>mean</span><span class='op'>)</span>

<span class='fu'>reduce.ignoringDiag</span><span class='op'>(</span><span class='va'>X</span>, aggregate <span class='op'>=</span> <span class='va'>mean</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pairwise</th>
      <td><p>the function for calculating (pairwise) semantic similarity
between term vectors. This function must accept the subsumer matrix as its
first argument. Additional named arguments (see <code>...</code>) may be passed to it
as well. See <a href='similarity.html'>similarity</a> for semantic similarity metrics available in this
package.</p></td>
    </tr>
    <tr>
      <th>subsumer_mat</th>
      <td><p>the subsumer matrix as data.frame. See <code><a href='subsumer_matrix.html'>subsumer_matrix()</a></code>
for more detail and the usual way for obtaining it.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional named arguments to be passed to the pairwise function.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>a <a href='https://rdrr.io/r/base/factor.html'>factor</a> (or an object coercible to factor) defining the group
(profile) membership of the terms (= columns) in the subsumer matrix.
Columns and rows of the resulting profile similarity matrix will take their
names from the levels of the factor. The factor may have 2 or more levels.</p></td>
    </tr>
    <tr>
      <th>reduce</th>
      <td><p>in pairwise mode, the function for reducing pairwise scores to
a single between-group score. In each invocation, the function will be passed
the submatrix of the pairwise similarity matrix that corresponds to the
pairwise scores of terms from the two profiles to be compared. A function
may aggregate the scores irrespective of the column and row structure of the
submatrix (for example, by taking the mean), or aggregate first by columns
or rows, followed by aggregating the results (for example, see <code>bestPairs()</code>).
In the latter case, the result may not be symmetric (i.e., s(p1,p2) != s(p2,p1)).</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>array or matrix, the submatrix of pairwise scores to aggregate</p></td>
    </tr>
    <tr>
      <th>best</th>
      <td><p>the function for determing the best score. The default is <code><a href='https://rdrr.io/r/base/Extremes.html'>max()</a></code>.</p></td>
    </tr>
    <tr>
      <th>aggregate</th>
      <td><p>the function for aggregating scores (for <code>reduce.ignoringDiag</code>)
or best pairwise scores (for <code>bestPairs</code>). For <code>reduce.ignoringDiag</code>, the
function must also accept parameter <code>na.rm</code>, and if the value is TRUE, remove
NA values before calculating the aggregate. The default is <code><a href='https://rdrr.io/r/base/mean.html'>mean()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A profile refers to a group of terms, and profile similarity to the similarity
between these groups. Profile similarity can be calculated in two principal
ways, often referred to as group-wise and pair-wise. Both are supported here.</p><ul>
<li><p>In group-wise mode, the terms and their subsumers in a group are first combined
into a single vector representing their union (also sometimes called the
subgraph corresponding to a group). Then the pairwise algorithm is applied to
the unions.</p></li>
<li><p>In pairwise mode, the pairwise similarities between all terms are calculated,
and then the pairwise scores between the terms in two groups are reduced
to a single score giving the between-group score.</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In pairwise mode, if the <code>reduce</code> function is asymmetric (as will typically be
the case for functions aggregating in two steps), the upper and lower triangle
of the profile similarity matrix will not be symmetric. If a symmetric similarity
matrix is desired, this can be achieved by computing <code>(X +  t(X)) / 2</code>, if X is
the profile similarity matrix.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pelvic fin"</span>, <span class='st'>"pectoral fin"</span>,
               <span class='st'>"forelimb"</span>, <span class='st'>"hindlimb"</span>, <span class='st'>"dorsal fin"</span>, <span class='st'>"caudal fin"</span><span class='op'>)</span>,
             <span class='va'>pk_get_iri</span>, as <span class='op'>=</span> <span class='st'>"anatomy"</span><span class='op'>)</span>

<span class='co'># define groups (profiles) as factors:</span>
<span class='va'>pairedUnpaired</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"paired"</span>, times <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"unpaired"</span>, times <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>finsLimbs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fins"</span>, <span class='st'>"fins"</span>, <span class='st'>"limbs"</span>, <span class='st'>"limbs"</span>, <span class='st'>"fins"</span>, <span class='st'>"fins"</span><span class='op'>)</span>
<span class='va'>pairedFinLimb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/interaction.html'>interaction</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>pairedUnpaired</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>finsLimbs</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># compute subsumer matrix</span>
<span class='va'>subs.mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subsumer_matrix.html'>subsumer_matrix</a></span><span class='op'>(</span><span class='va'>tt</span>, .colnames <span class='op'>=</span> <span class='st'>"label"</span>, .labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>)</span>,
                            preserveOrder <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='co'># group-wise profile similarity:</span>
<span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedUnpaired</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             paired  unpaired
#&gt; paired   1.0000000 0.3366337
#&gt; unpaired 0.3366337 1.0000000</div><div class='input'><span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>finsLimbs</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            fins     limbs
#&gt; fins  1.0000000 0.7722772
#&gt; limbs 0.7722772 1.0000000</div><div class='input'><span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedFinLimb</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins     1.0000000     0.3695652    0.8210526
#&gt; unpaired.fins   0.3695652     1.0000000    0.3368421
#&gt; paired.limbs    0.8210526     0.3368421    1.0000000</div><div class='input'>
<span class='co'># pairwise, using mean (average pairwise score); result is symmetric</span>
<span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedFinLimb</span>,
                   reduce <span class='op'>=</span> <span class='va'>mean</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins     0.9418605     0.3964696    0.8310345
#&gt; unpaired.fins   0.3964696     0.9250000    0.3641711
#&gt; paired.limbs    0.8310345     0.3641711    0.9310345</div><div class='input'><span class='co'># the same, but excluding self-similarity of terms within groups</span>
<span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedFinLimb</span>,
                   reduce <span class='op'>=</span> <span class='va'>reduce.ignoringDiag</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins     0.8837209     0.3964696    0.8310345
#&gt; unpaired.fins   0.3964696     0.8500000    0.3641711
#&gt; paired.limbs    0.8310345     0.3641711    0.8620690</div><div class='input'><span class='co'># pairwise, using max; result is symmetric</span>
<span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedFinLimb</span>,
                   reduce <span class='op'>=</span> <span class='va'>max</span><span class='op'>)</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins     1.0000000     0.3975904    0.8620690
#&gt; unpaired.fins   0.3975904     1.0000000    0.3647059
#&gt; paired.limbs    0.8620690     0.3647059    1.0000000</div><div class='input'><span class='co'># pairwise, using average of best pairs; result is _not_ symmetric</span>
<span class='va'>sm</span> <span class='op'>&lt;-</span> <span class='fu'>profile_similarity</span><span class='op'>(</span><span class='va'>jaccard_similarity</span>, <span class='va'>subs.mat</span>, f <span class='op'>=</span> <span class='va'>pairedFinLimb</span>,
                         reduce <span class='op'>=</span> <span class='va'>bestPairs</span><span class='op'>)</span>
<span class='va'>sm</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins     1.0000000     0.3975904    0.8620690
#&gt; unpaired.fins   0.3964696     1.0000000    0.3641711
#&gt; paired.limbs    0.8620690     0.3647059    1.0000000</div><div class='input'><span class='co'># make symmtric, for example by averaging:</span>
<span class='op'>(</span><span class='va'>sm</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>sm</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>
</div><div class='output co'>#&gt;               paired.fins unpaired.fins paired.limbs
#&gt; paired.fins      1.000000     0.3970300    0.8620690
#&gt; unpaired.fins    0.397030     1.0000000    0.3644385
#&gt; paired.limbs     0.862069     0.3644385    1.0000000</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


