<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Drop parts of a nexml object — nexml_drop • rphenoscape</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Drop parts of a nexml object — nexml_drop" />
<meta property="og:description" content="nexml_drop_otu drops OTUs (taxa) from a nexml object.
Currently none of the OTUs to be dropped can be used in a tree that's part
of the nexml object. If they are, first drop the OTUs from the tree(s)
(for example, using drop.tip() from package &quot;ape&quot;), then
replace the tree(s). Dropping OTUs will not only drop them from the OTUs
block, but will also drop matrix rows that referenced the OTUs to be dropped.
This may in turn leave some characters unused. Therefore, it is recommended
to drop unused characters afterwards.
nexml_drop_char drops characters from a nexml object. Note
that dropping characters may make some OTUs unused if they result in empty
rows and empty rows are pruned (see parameter pruneRows). It is therefore
recommended to drop unused OTUs afterwards.
is_unused_char is a filter function for nexml_drop_char for dropping
unused characters.
is_unused_otu is a filter function for nexml_drop_otu for dropping
unused OTUs." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/phenoscape/rphenoscape/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Drop parts of a nexml object</h1>
    <small class="dont-index">Source: <a href='https://github.com/phenoscape/rphenoscape/blob/master/R/nexml.R'><code>R/nexml.R</code></a></small>
    <div class="hidden name"><code>nexml_drop.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>nexml_drop_otu</code> drops OTUs (taxa) from a <a href='https://docs.ropensci.org/RNeXML/reference/nexml-class.html'>nexml</a> object.
Currently none of the OTUs to be dropped can be used in a tree that's part
of the <code>nexml</code> object. If they are, first drop the OTUs from the tree(s)
(for example, using <a href='https://rdrr.io/pkg/ape/man/drop.tip.html'>drop.tip()</a> from package "ape"), then
replace the tree(s). Dropping OTUs will not only drop them from the OTUs
block, but will also drop matrix rows that referenced the OTUs to be dropped.
This may in turn leave some characters unused. Therefore, it is recommended
to drop unused characters afterwards.</p>
<p><code>nexml_drop_char</code> drops characters from a <a href='https://docs.ropensci.org/RNeXML/reference/nexml-class.html'>nexml</a> object. Note
that dropping characters may make some OTUs unused if they result in empty
rows and empty rows are pruned (see parameter <code>pruneRows</code>). It is therefore
recommended to drop unused OTUs afterwards.</p>
<p><code>is_unused_char</code> is a filter function for <code>nexml_drop_char</code> for dropping
unused characters.</p>
<p><code>is_unused_otu</code> is a filter function for <code>nexml_drop_otu</code> for dropping
unused OTUs.</p>
    </div>

    <pre class="usage"><span class='fu'>nexml_drop_otu</span><span class='op'>(</span><span class='va'>nexml</span>, <span class='va'>filter</span>, at <span class='op'>=</span> <span class='cn'>NA</span>, block <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>nexml_drop_char</span><span class='op'>(</span><span class='va'>nexml</span>, <span class='va'>filter</span>, at <span class='op'>=</span> <span class='cn'>NA</span>, block <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span>,
  pruneStates <span class='op'>=</span> <span class='cn'>TRUE</span>, pruneRows <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>is_unused_char</span><span class='op'>(</span><span class='va'>charList</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>is_unused_otu</span><span class='op'>(</span><span class='va'>otuList</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nexml</th>
      <td><p>the <a href='https://docs.ropensci.org/RNeXML/reference/nexml-class.html'>nexml</a> object from which to drop parts</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>logical, or a function returning a logical. If the latter,
it will be passed the list of selected values for filtering (see parameter
<code>at</code>), and any additional parameters (see <code>...</code>). The logical vector selects
the list elements to drop from the given block (see <code>block</code>).</p></td>
    </tr>
    <tr>
      <th>at</th>
      <td><p>character, selects the values for filtering if <code>filter</code> is a
function. If <code>NA</code> (the default), a list of the respective objects (<code>otu</code>
and <code>char</code>, respectively) are passed. If a string and the value matches
a slot of the objects (such as "id", "label"), a list of those slot values
is passed. Otherwise, it is assumed to be a metadata property for those
objects, and a list of the respective metadata values is selected (with
<code>NA</code> for objects that do not have a matching metadata annotation).</p></td>
    </tr>
    <tr>
      <th>block</th>
      <td><p>integer, the respective block index (for OTUs and character
blocks, respectively).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>for <code>nexml_drop_otu</code> and <code>nexml_drop_char</code>, additional parameters
to be passed on to the filter function.</p>
<p>For <code>is_unused_char</code> and <code>is_unused_otu</code>, if used outside of serving as
value for the <code>filter</code> parameter, a parameter <code>characters</code> with
the characters block (or list thereof), and/or a parameter <code>nexml</code> with the
nexml object, must be provided. If only <code>nexml</code> is passed, all characters
blocks is assumed.</p>
<p><code>is_unused_otu</code> also accepts <code>ignoreTrees</code> (default is <code>FALSE</code>). If set to
<code>TRUE</code>, trees will be ignored for determining whether an OTU is unused.
Otherwise, if <code>nexml</code> is <em>not</em> passed to <code>is_unused_otu</code>, a warning will be
issued that it cannot check trees for determining the use of OTUs.</p></td>
    </tr>
    <tr>
      <th>pruneStates</th>
      <td><p>logical, whether to also prune (i.e., drop) states that
are no longer used after dropping the selected characters. The default is
TRUE.</p></td>
    </tr>
    <tr>
      <th>pruneRows</th>
      <td><p>logical, whether to also prune (i.e., drop) matrix rows
that have become empty (i.e., have no cells left) after dropping the
selected characters. The default is TRUE.</p></td>
    </tr>
    <tr>
      <th>charList</th>
      <td><p>a list of <code>char</code> objects. This will be passed as the values
to filter on.</p></td>
    </tr>
    <tr>
      <th>otuList</th>
      <td><p>a list of <code>otu</code> objects. This will be passed as the values
to filter on.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The functions for dropping components return a <a href='https://docs.ropensci.org/RNeXML/reference/nexml-class.html'>nexml</a>
object with the filtered components dropped.</p>
<p><code>is_unused_char</code> returns a logical vector with TRUE for each <code>char</code>
(character) object that is not used in the matrix (or matrices) of the
characters block(s), and FALSE  otherwise.</p>
<p><code>is_unused_otu</code> returns a logical vector with TRUE for each <code>otu</code>
object that is not used in either the matrix (or matrices) of the characters
block(s), or, unless <code>ignoreTrees = TRUE</code>, for a node of a tree, and FALSE
otherwise.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>nex</span> <span class='op'>&lt;-</span> <span class='fu'>RNeXML</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/RNeXML/reference/nexml_read.html'>nexml_read</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"examples"</span>, <span class='st'>"ontotrace-result.xml"</span>, package <span class='op'>=</span> <span class='st'>"rphenoscape"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># drop by label matching</span>
<span class='fu'>nexml_drop_otu</span><span class='op'>(</span><span class='va'>nex</span>, filter <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>" sp."</span>, <span class='va'>x</span><span class='op'>)</span>, at <span class='op'>=</span> <span class='st'>"label"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; A nexml object representing:
#&gt;  	 1 phylogenetic tree block(s), where:
#&gt; 	   block 1 contains 0 phylogenetic tree(s) 
#&gt;  	 1 character block(s), where:
#&gt; 	   block 1 defines 3 standard/discrete character(s), with 2 states each 
#&gt; 	    and  2 polymorphic or uncertain state(s) defined 
#&gt; 	   matrix 1 has 8 row(s) 
#&gt;  	 8 taxonomic units in 1 block(s) 
#&gt;   Taxa:	 Ictalurus punctatus, Ictalurus mexicanus, Ictalurus australis, Ictalurus balsanus, Ictalurus pricei, Ictalurus furcatus ...
#&gt;   Metadata annotations: 
#&gt; 	18 at top level 
#&gt; 	9 in block 1 at otu level 
#&gt; 	3 in block 1 at char level 
#&gt; 	0 in block 1 at state level
#&gt; 
#&gt; Original description: Generated from the Phenoscape Knowledgebase on 2015-10-21 by Ontotrace query:
#&gt; * taxa: &lt;http://purl.obolibrary.org/obo/VTO_0036217&gt;
#&gt; * entities: &lt;http://purl.obolibrary.org/obo/BFO_0000050&gt; some &lt;http://purl.obolibrary.org/obo/UBERON_0008897&gt;
#&gt; Modified with: nexml_drop_otu(nex, filter = function(x) grepl(" sp.", x), at = "label")
#&gt; 
#&gt; Author(s): , lapp
#&gt; 
#&gt; NeXML generated by RNeXML using schema version: 0.9 
#&gt; Size: 209.6 Kb </div><div class='input'>
<span class='co'># can pipe dropping and then removing potentially unused characters or OTUs:</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='fu'>nexml_drop_char</span><span class='op'>(</span><span class='va'>nex</span>, filter <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"pelvic"</span>, <span class='va'>x</span><span class='op'>)</span>, at <span class='op'>=</span> <span class='st'>"label"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>nexml_drop_otu</span><span class='op'>(</span>filter <span class='op'>=</span> <span class='va'>is_unused_otu</span><span class='op'>)</span>
</div><div class='output co'>#&gt; A nexml object representing:
#&gt;  	 1 phylogenetic tree block(s), where:
#&gt; 	   block 1 contains 0 phylogenetic tree(s) 
#&gt;  	 1 character block(s), where:
#&gt; 	   block 1 defines 2 standard/discrete character(s), with 2 states each 
#&gt; 	    and  1 polymorphic or uncertain state(s) defined 
#&gt; 	   matrix 1 has 8 row(s) 
#&gt;  	 8 taxonomic units in 1 block(s) 
#&gt;   Taxa:	 Ictalurus punctatus, Ictalurus mexicanus, Ictalurus australis, Ictalurus balsanus, Ictalurus pricei, Ictalurus furcatus ...
#&gt;   Metadata annotations: 
#&gt; 	33 at top level 
#&gt; 	9 in block 1 at otu level 
#&gt; 	2 in block 1 at char level 
#&gt; 	0 in block 1 at state level
#&gt; 
#&gt; Original description: Generated from the Phenoscape Knowledgebase on 2015-10-21 by Ontotrace query:
#&gt; * taxa: &lt;http://purl.obolibrary.org/obo/VTO_0036217&gt;
#&gt; * entities: &lt;http://purl.obolibrary.org/obo/BFO_0000050&gt; some &lt;http://purl.obolibrary.org/obo/UBERON_0008897&gt;
#&gt; Modified with: nexml_drop_char(nex, filter = function(x) grepl("pelvic", x), 
#&gt;     at = "label")
#&gt; Modified with: nexml_drop_otu(., filter = is_unused_otu)
#&gt; 
#&gt; Author(s): , lapp, lapp
#&gt; 
#&gt; NeXML generated by RNeXML using schema version: 0.9 
#&gt; Size: 205.8 Kb </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>nex</span> <span class='op'>&lt;-</span> <span class='fu'><a href='pk_get_ontotrace_xml.html'>pk_get_ontotrace_xml</a></span><span class='op'>(</span>taxon <span class='op'>=</span> <span class='st'>"Ictaluridae"</span>,
                            entity <span class='op'>=</span> <span class='st'>"fin"</span>, variable_only <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='co'># ontotrace results store VTO IRIs in dwc:taxonID annotations:</span>
<span class='fu'>nexml_drop_otu</span><span class='op'>(</span><span class='va'>nex</span>,
               filter <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>!</span><span class='fu'><a href='pk_is_descendant.html'>pk_is_descendant</a></span><span class='op'>(</span><span class='st'>"Ictalurus"</span>, <span class='va'>x</span><span class='op'>)</span>,
               at <span class='op'>=</span> <span class='st'>"dwc:taxonID"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>nexml_drop_char</span><span class='op'>(</span>filter <span class='op'>=</span> <span class='va'>is_unused_char</span><span class='op'>)</span>
<span class='co'># anatomy IRIs are in obo:IAO_0000219 ("denotes") annotations:</span>
<span class='fu'>nexml_drop_char</span><span class='op'>(</span><span class='va'>nex</span>,
               filter <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
                 <span class='op'>!</span><span class='fu'><a href='pk_is_descendant.html'>pk_is_descendant</a></span><span class='op'>(</span><span class='st'>"paired fin"</span>, <span class='va'>x</span>, includeRels <span class='op'>=</span> <span class='st'>"part_of"</span><span class='op'>)</span>,
               at <span class='op'>=</span> <span class='st'>"obo:IAO_0000219"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>nexml_drop_otu</span><span class='op'>(</span>filter <span class='op'>=</span> <span class='va'>is_unused_otu</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


