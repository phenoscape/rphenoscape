<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Obtain a synthetic presence/absence matrix — get_ontotrace_data • rphenoscape</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Obtain a synthetic presence/absence matrix — get_ontotrace_data"><meta property="og:description" content="Queries the Phenoscape KB for a synthetic presence/absence character matrix
for the given taxa and anatomical entities, and returns the result as a
nexml object (from the RNeXML package)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/phenoscape/rphenoscape/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Obtain a synthetic presence/absence matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/HEAD/R/ontotrace.R" class="external-link"><code>R/ontotrace.R</code></a></small>
    <div class="hidden name"><code>get_ontotrace_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Queries the Phenoscape KB for a synthetic presence/absence character matrix
for the given taxa and anatomical entities, and returns the result as a
<a href="https://docs.ropensci.org/RNeXML/reference/nexml-class.html" class="external-link">nexml</a> object (from the RNeXML package).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_ontotrace_data</span><span class="op">(</span></span>
<span>  <span class="va">taxon</span>,</span>
<span>  <span class="va">entity</span>,</span>
<span>  relation <span class="op">=</span> <span class="st">"part of"</span>,</span>
<span>  variable_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  strict <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  subsume <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>taxon</dt>
<dd><p>character or object of type "owlmn", required. A vector of taxon names
or a single OWL Manchester expression object. <code><a href="owl.html">as.owl()</a></code> can be used to create a
OWL Manchester expression object.</p></dd>


<dt>entity</dt>
<dd><p>character or object of type "owlmn", required. A vector of entity names
or a single OWL Manchester expression object. <code><a href="owl.html">as.owl()</a></code> can be used to create a
OWL Manchester expression object.</p></dd>


<dt>relation</dt>
<dd><p>character string, optional.
The relationship to the entities to be included in the result. Must be
either "part of" or "develops from", or set to NA to disable.
Default is "part of".</p></dd>


<dt>variable_only</dt>
<dd><p>logical, optional.
Whether to only include characters that are variable across the selected
set of taxa. Default is TRUE.</p></dd>


<dt>strict</dt>
<dd><p>logical, optional. Whether or not to treat any failure to resolve
any taxon or entity names to IRI as input error. Resolution by partial or
other inexact match results in a warning, but is not considered a failure.
If FALSE, query execution will continue with the taxon and entity terms
that did resolve to IRI. Default is TRUE, meaning any resolution failure will
result in an error. <em>All</em> taxon or entity names failing resolution to IRIs will
result in an error regardless.</p></dd>


<dt>subsume</dt>
<dd><p>logical, optional. If TRUE (the default), taxon and entity parameters include their logical descendants.
Ignored if entity or taxon is a OWL Manchester expression object (which always include logical descendants).
If set to FALSE, <em>only</em> data for the given taxa and entities will be returned.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><a href="https://docs.ropensci.org/RNeXML/reference/nexml-class.html" class="external-link">RNeXML::nexml</a> object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The character matrix includes both asserted and logically inferred states. The
query always includes all subclasses of both taxa and entities, and by default
also includes all parts of the entities. See parameter <code>relation</code> for changing
this. By default, only characters that are variable across the resulting taxa
are included; use <code>variable_only</code> to change this.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># one taxon (including subclasses), one entity (including subclasses and </span></span></span>
<span class="r-in"><span><span class="co"># by default its parts)</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="st">"Ictalurus"</span>, entity <span class="op">=</span> <span class="st">"fin"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same as above, except do not include parts or other relationships (fin</span></span></span>
<span class="r-in"><span><span class="co"># presence/absence does not vary across Ictalurus, hence need to allow</span></span></span>
<span class="r-in"><span><span class="co"># non-variable characters)</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="st">"Ictalurus"</span>, entity <span class="op">=</span> <span class="st">"fin"</span>,</span></span>
<span class="r-in"><span>                          relation <span class="op">=</span> <span class="cn">NA</span>, variable_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># instead of parts, include entities in develops_from relationship to the query entity</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="st">"Ictalurus"</span>, entity <span class="op">=</span> <span class="st">"paired fin bud"</span>,</span></span>
<span class="r-in"><span>                          relation <span class="op">=</span> <span class="st">"develops from"</span>, variable_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># query with multiple taxa, and/or multiple entities:</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ictalurus"</span>, <span class="st">"Ameiurus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          entity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pectoral fin"</span>, <span class="st">"pelvic fin"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># query disabling subsumption with multiple taxa, and/or multiple entities</span></span></span>
<span class="r-in"><span><span class="fu">get_ontotrace_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>    taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ictalurus australis"</span>, <span class="st">"Ictalurus balsanus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    entity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anterior dentation of pectoral fin spine"</span>, <span class="st">"pelvic splint"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    subsume <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># query using taxon and/or entity owl expressions</span></span></span>
<span class="r-in"><span><span class="va">taxon_owl</span> <span class="op">&lt;-</span> <span class="fu"><a href="owl.html">as.owl</a></span><span class="op">(</span><span class="st">"&lt;http://purl.obolibrary.org/obo/VTO_0036217&gt;"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">entity_owl</span> <span class="op">&lt;-</span> <span class="fu"><a href="owl.html">as.owl</a></span><span class="op">(</span><span class="st">"&lt;http://purl.obolibrary.org/obo/UBERON_0008897&gt; or</span></span></span>
<span class="r-in"><span><span class="st">   (&lt;http://purl.obolibrary.org/obo/BFO_0000050&gt; some</span></span></span>
<span class="r-in"><span><span class="st">    &lt;http://purl.obolibrary.org/obo/UBERON_0008897&gt;)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">taxon_owl</span>, entity <span class="op">=</span> <span class="va">entity_owl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># query using taxon and/or entity owl expressions resolved from label expressions</span></span></span>
<span class="r-in"><span><span class="va">taxon_owl</span> <span class="op">&lt;-</span> <span class="fu"><a href="owl.html">as.owl</a></span><span class="op">(</span><span class="st">"Ictalurus"</span>, usesLabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">entity_owl</span> <span class="op">&lt;-</span> <span class="fu"><a href="owl.html">as.owl</a></span><span class="op">(</span><span class="st">"'fin' or ('part of' some 'fin')"</span>, usesLabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nex</span> <span class="op">&lt;-</span> <span class="fu">get_ontotrace_data</span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">taxon_owl</span>, entity <span class="op">=</span> <span class="va">entity_owl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the RNeXML API to obtain the character matrix etc:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">RNeXML</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/RNeXML/reference/get_characters.html" class="external-link">get_characters</a></span><span class="op">(</span><span class="va">nex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>      <span class="co"># number of taxa and characters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="co"># taxon names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="co"># characters (entity names)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

