<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute semantic similarity metrics between terms — similarity • rphenoscape</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute semantic similarity metrics between terms — similarity"><meta property="og:description" content="The Tanimoto similarity ST is computed according to the definition for bit vectors
(see Jaccard index at Wikipedia).
For weights \(W_i \in \{0, 1\}\) it is the same as the
Jaccard similarity.
The Tanimoto similarity can be computed for any term vectors, but for 1 - ST
to be a proper distance metric satisfying the triangle inequality,
\(M_{i,j} \in \{0, W_i\}\) must hold.
The Jaccard similarity is computed using the Tanimoto similarity definition
for bit vectors
(see Jaccard index at Wikipedia).
For the results to be a valid Jaccard similarity, weights must be zero and
one. If any weights are different, a warning is issued.
The Cosine similarity SC is computed using the Euclidean dot product formula.
See Cosine similarity on Wikipedia.
The metric is valid for any term vectors (columns of the subsumer matrix), i.e.,
\(M_{i,j} \in \{0, W_i\}\) is not required. Note that
1 - SC is not a proper distance metric, because it violates the triangle
inequality. First convert to angle to obtain a distance metric.
The Resnik similarity between two terms is the information content (IC) of
their most informative common ancestor (MICA), which is the common subsumer
with the greatest information content."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/phenoscape/rphenoscape/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute semantic similarity metrics between terms</h1>
    <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/HEAD/R/semsim.R" class="external-link"><code>R/semsim.R</code></a></small>
    <div class="hidden name"><code>similarity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Tanimoto similarity ST is computed according to the definition for bit vectors
(see <a href="https://en.wikipedia.org/wiki/Jaccard_index#Tanimoto" s_definitions_of_similarity_and_distance class="external-link">Jaccard index at Wikipedia</a>).
For weights \(W_i \in \{0, 1\}\) it is the same as the
Jaccard similarity.
The Tanimoto similarity can be computed for any term vectors, but for 1 - ST
to be a proper distance metric satisfying the triangle inequality,
\(M_{i,j} \in \{0, W_i\}\) must hold.</p>
<p>The Jaccard similarity is computed using the Tanimoto similarity definition
for bit vectors
(see <a href="https://en.wikipedia.org/wiki/Jaccard_index#Tanimoto" s_definitions_of_similarity_and_distance class="external-link">Jaccard index at Wikipedia</a>).
For the results to be a valid Jaccard similarity, weights must be zero and
one. If any weights are different, a warning is issued.</p>
<p>The Cosine similarity <em>SC</em> is computed using the Euclidean dot product formula.
See <a href="https://en.wikipedia.org/wiki/Cosine_similarity#Definition" class="external-link">Cosine similarity on Wikipedia</a>.
The metric is valid for any term vectors (columns of the subsumer matrix), i.e.,
\(M_{i,j} \in \{0, W_i\}\) is not required. Note that
1 - <em>SC</em> is not a proper distance metric, because it violates the triangle
inequality. First convert to angle to obtain a distance metric.</p>
<p>The Resnik similarity between two terms is the information content (IC) of
their most informative common ancestor (MICA), which is the common subsumer
with the greatest information content.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tanimoto_similarity</span><span class="op">(</span>subsumer_mat <span class="op">=</span> <span class="cn">NA</span>, terms <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">jaccard_similarity</span><span class="op">(</span>subsumer_mat <span class="op">=</span> <span class="cn">NA</span>, terms <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cosine_similarity</span><span class="op">(</span>subsumer_mat <span class="op">=</span> <span class="cn">NA</span>, terms <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">resnik_similarity</span><span class="op">(</span></span>
<span>  subsumer_mat <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  wt <span class="op">=</span> <span class="va">term_freqs</span>,</span>
<span>  wt_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  base <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>subsumer_mat</dt>
<dd><p>matrix or data.frame, the vector-encoded matrix M of
subsumers for which \(M_{i,j} = W_i, W_i &gt; 0\) (W = weights),
if class <em>i</em> subsumes term j, and 0 otherwise. A binary
(\(M_{i,j} \in \{0, 1\}\)) encoding (i.e., W[<em>i</em>] = 1)
can be obtained from <code><a href="subsumer_matrix.html">subsumer_matrix()</a></code>.</p></dd>


<dt>terms</dt>
<dd><p>character, optionally the list of terms (as IRIs and/or labels)
for which to generate a properly encoded subsumer matrix on the fly.</p></dd>


<dt>...</dt>
<dd><p>parameters to be passed on to <code><a href="subsumer_matrix.html">subsumer_matrix()</a></code>
if a subsumer matrix is to be generated on the fly.</p></dd>


<dt>wt</dt>
<dd><p>numeric or a function. If numeric, weights for the subsumer terms.
For <code>resnik_similarity</code>, these are expected to be information content (IC)
scores, though any score will work for which a higher value means higher
information content, and where a term will always have a score equal to or
greater than any of its superclasses. If a function, it must accept parameter
<code>x</code> as the vector of term IRIs and return a vector of frequencies (<em>not</em>
IC scores) for the terms. The default is to use function <code><a href="term_freqs.html">term_freqs()</a></code>.
Subsumer terms with zero or missing (NA) frequency will be omitted from
the calculation.</p></dd>


<dt>wt_args</dt>
<dd><p>list, named parameters for the function calculating term
frequencies. Ignored if <code>wt</code> is not a function. For the default <code>wt</code>
function <code><a href="term_freqs.html">term_freqs()</a></code>, the main parameters are <code>as</code> and <code>corpus</code>.</p></dd>


<dt>base</dt>
<dd><p>integer, the base of the logarithm for calculating information
content from term frequency. The default is 10.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix with M[i,j] = similarity of terms <em>i</em> and <em>j</em>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Philip Resnik (1995). "Using information content to evaluate semantic
similarity in a taxonomy". Proceedings of the 14th International Joint
Conference on Artificial Intelligence (IJCAI'95). <strong>1</strong>: 448–453</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu">jaccard_similarity</span><span class="op">(</span>terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pelvic fin"</span>, <span class="st">"pectoral fin"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"forelimb"</span>, <span class="st">"hindlimb"</span>,</span></span>
<span class="r-in"><span>                                   <span class="st">"dorsal fin"</span>, <span class="st">"caudal fin"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         .colnames <span class="op">=</span> <span class="st">"label"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              pectoral fin pelvic fin  forelimb  hindlimb dorsal fin caudal fin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pectoral fin    1.0000000  0.8431373 0.8269231 0.7272727  0.5600000  0.5306122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pelvic fin      0.8431373  1.0000000 0.7272727 0.8269231  0.5600000  0.5306122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> forelimb        0.8269231  0.7272727 1.0000000 0.7777778  0.5192308  0.4901961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> hindlimb        0.7272727  0.8269231 0.7777778 1.0000000  0.5192308  0.4901961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dorsal fin      0.5600000  0.5600000 0.5192308 0.5192308  1.0000000  0.8437500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> caudal fin      0.5306122  0.5306122 0.4901961 0.4901961  0.8437500  1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># e.g., turn into distance matrix, cluster, and plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="similarity-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">phens</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_phenotypes.html">get_phenotypes</a></span><span class="op">(</span><span class="st">"basihyal bone"</span>, taxon <span class="op">=</span> <span class="st">"Cyprinidae"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sm.ic</span> <span class="op">&lt;-</span> <span class="fu">resnik_similarity</span><span class="op">(</span>terms <span class="op">=</span> <span class="va">phens</span><span class="op">$</span><span class="va">id</span>,</span></span>
<span class="r-in"><span>                           .colnames <span class="op">=</span> <span class="st">"label"</span>, .labels <span class="op">=</span> <span class="va">phens</span><span class="op">$</span><span class="va">label</span>,</span></span>
<span class="r-in"><span>                           wt_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>as <span class="op">=</span> <span class="st">"phenotype"</span>,</span></span>
<span class="r-in"><span>                                          corpus <span class="op">=</span> <span class="st">"taxa"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maxIC</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="corpus_size.html">corpus_size</a></span><span class="op">(</span><span class="st">"taxa"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># normalize by max IC, turn into distance matrix, cluster, and plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">sm.ic</span><span class="op">/</span><span class="va">maxIC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

