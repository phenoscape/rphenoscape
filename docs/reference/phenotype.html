<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Phenotype Objects — phenotype • rphenoscape</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Phenotype Objects — phenotype" />
<meta property="og:description" content="as.phenotype creates an object (or a list of objects) of type &quot;phenotype&quot;.
The object to be coerced can be a character vector (of IRIs), or a data.frame.
In the latter case, there must be a column &quot;id&quot; with the IRIs of phenotypes.
If the object is already of type &quot;phenotype&quot;, it is passed through unchanged.
is.phenotype tests whether an object is of type &quot;phenotype&quot;
is_valid_phenotype tests which of the objects in the list are valid
phenotype objects, and returns a logical vector of the same length as x.
An object is a valid phenotype object if it is of type &quot;phenotype&quot; and its
ID has been found in the database.
charstates extracts the character states from the phenotype object (or an
object coercible to phenotype)
chars extracts the (non-redundant) characters from the phenotype object (or an object
coercible to phenotype).
print pretty-prints objects of type &quot;phenotype&quot;" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/phenoscape/rphenoscape/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phenotype Objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/phenoscape/rphenoscape/blob/master/R/phen_obj.R'><code>R/phen_obj.R</code></a></small>
    <div class="hidden name"><code>phenotype.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>as.phenotype</code> creates an object (or a list of objects) of type "phenotype".
The object to be coerced can be a character vector (of IRIs), or a data.frame.
In the latter case, there must be a column "id" with the IRIs of phenotypes.
If the object is already of type "phenotype", it is passed through unchanged.</p>
<p><code>is.phenotype</code> tests whether an object is of type "phenotype"</p>
<p><code>is_valid_phenotype</code> tests which of the objects in the list are valid
phenotype objects, and returns a logical vector of the same length as <code>x</code>.
An object is a valid phenotype object if it is of type "phenotype" and its
ID has been found in the database.</p>
<p><code>charstates</code> extracts the character states from the phenotype object (or an
object coercible to phenotype)</p>
<p><code>chars</code> extracts the (non-redundant) characters from the phenotype object (or an object
coercible to phenotype).</p>
<p><code>print</code> pretty-prints objects of type "phenotype"</p>
    </div>

    <pre class="usage"><span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>x</span>, withTaxa <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>is.phenotype</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>is_valid_phenotype</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>charstates</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='fu'>chars</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S3 method for phenotype</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of type "phenotype" or coercible to it, or to be tested
for being of type "phenotype"</p></td>
    </tr>
    <tr>
      <th>withTaxa</th>
      <td><p>logical. If TRUE taxa exhibiting the phenotype will be
available through the phenotype object at key "taxa". Default is FALSE, because
obtaining taxa requires an additional query per object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters where applicable; ignored for printing</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>as.phenotype</code> returns and object of type "phenotype", or a list of such objects
if the object to be coerced had multiple elements (if a vector) or rows (if a
data.frame). A phenotype object has properties "id" (ID, i.e., IRI of the
phenotype), "label" (label of the phenotype if one exists), "states" (a
data.frame of the character states to which the phenotype is linked, see value
for <code>charstates</code>), and "eqs" (the EQ expression components as a list with keys
"entities", "qualities", and "related_entities"). If <code>withTaxa</code> is TRUE,
there will also be a key "taxa" (a data.frame with columns "id" and "label").</p>
<p><code>is.phenotype</code> returns TRUE if the object is of type "phenotype" and FALSE
otherwise.</p>
<p><code>is_valid_phenotype</code> returns a logical vector of the same length as the input
array of objects, with TRUE for those objects in the list that are of type
"phenotype" and correspond to a phenotype in the database.</p>
<p><code>charstates</code> returns a data.frame. If called with a single phenotype object
(or an object that coerces to one), the data.frame has columns "id" and "label" (for the
character state), "character.id" and "character.label" (IRI and label
of the character), and "study.id" and "study.label" (IRI and short label for
the study to which the character and state belong). If called with a list of
phenotype objects (or objects that coerce to such a list), the data.frame will
include the character states from all phenotypes in the list. In this case,
the character state columns will be "state.id" and "state.label", respectively,
and there will be two additional columns, "phenotype.id" and "phenotype.label".</p>
<p><code>chars</code> returns  a data.frame with collumns "character.id" and "character.label"
(IRI and label of the character), and "study.id" and "study.label" (IRI and
short label for the study to which the character and state belong).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Create and test objects of type "phenotype", and extract properties from them.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># query for a set of phenotypes (IDs and their labels)</span>
<span class='va'>phens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_phenotypes.html'>get_phenotypes</a></span><span class='op'>(</span>entity <span class='op'>=</span> <span class='st'>"basihyal bone"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>phens</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 20</div><div class='input'><span class='co'># turn one into a phenotype object</span>
<span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>phens</span><span class='op'>[</span><span class='fl'>3</span>, <span class='st'>"id"</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "phenotype" "list"     </div><div class='input'><span class='va'>obj</span>
</div><div class='output co'>#&gt; Phenotype 'basihyal bone absent'
#&gt; Linked to states:
#&gt;                label character.label           study.label
#&gt; 1  states 0, 1 and 2        Basihyal Imamura et al. (2005)
#&gt; 2 absent (unordered)        Basihyal Imamura et al. (2005)
#&gt; 3             Absent   Basihyal bone  Mabee et al.  (2011)
#&gt; 4    basihyal absent        Basihyal       De Pinna (1993)
#&gt; 
#&gt; Entities:
#&gt;     multicellular organism &lt;http://purl.obolibrary.org/obo/UBERON_0000468&gt;
#&gt; Qualities:
#&gt;     lacks all parts of type &lt;http://purl.obolibrary.org/obo/PATO_0002000&gt;
#&gt; Towards:
#&gt;     basihyal bone &lt;http://purl.obolibrary.org/obo/UBERON_0011618&gt;
#&gt; 
#&gt; No information about taxa exhibiting this phenotype.</div><div class='input'>
<span class='co'># optionally include taxa exhibiting the phenotype</span>
<span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>phens</span><span class='op'>[</span><span class='fl'>3</span>,<span class='op'>]</span>, withTaxa <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Phenotype 'basihyal bone absent'
#&gt; Linked to states:
#&gt;                label character.label           study.label
#&gt; 1  states 0, 1 and 2        Basihyal Imamura et al. (2005)
#&gt; 2 absent (unordered)        Basihyal Imamura et al. (2005)
#&gt; 3             Absent   Basihyal bone  Mabee et al.  (2011)
#&gt; 4    basihyal absent        Basihyal       De Pinna (1993)
#&gt; 
#&gt; Entities:
#&gt;     multicellular organism &lt;http://purl.obolibrary.org/obo/UBERON_0000468&gt;
#&gt; Qualities:
#&gt;     lacks all parts of type &lt;http://purl.obolibrary.org/obo/PATO_0002000&gt;
#&gt; Towards:
#&gt;     basihyal bone &lt;http://purl.obolibrary.org/obo/UBERON_0011618&gt;
#&gt; Exhibited by taxa:
#&gt;                                           id                    label
#&gt; 1 http://purl.obolibrary.org/obo/VTO_0035423        Corydoras rabauti
#&gt; 2 http://purl.obolibrary.org/obo/VTO_0052870        Enophrys diceraus
#&gt; 3 http://purl.obolibrary.org/obo/VTO_0071753 Eumicrotremus asperrimus
#&gt; 4 http://purl.obolibrary.org/obo/VTO_0052740   Hemitripterus villosus
#&gt; 5 http://purl.obolibrary.org/obo/VTO_0052539        Liparis agassizii
#&gt;  [ reached 'max' / getOption("max.print") -- omitted 6 rows ]</div><div class='input'><span class='co'># full list of taxa:</span>
<span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>phens</span><span class='op'>[</span><span class='fl'>3</span>,<span class='op'>]</span>, withTaxa <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>$</span><span class='va'>taxa</span>
</div><div class='output co'>#&gt;                                            id                      label
#&gt; 1  http://purl.obolibrary.org/obo/VTO_0035423          Corydoras rabauti
#&gt; 2  http://purl.obolibrary.org/obo/VTO_0052870          Enophrys diceraus
#&gt; 3  http://purl.obolibrary.org/obo/VTO_0071753   Eumicrotremus asperrimus
#&gt; 4  http://purl.obolibrary.org/obo/VTO_0052740     Hemitripterus villosus
#&gt; 5  http://purl.obolibrary.org/obo/VTO_0052539          Liparis agassizii
#&gt; 6  http://purl.obolibrary.org/obo/VTO_0052645       Malacocottus zonurus
#&gt; 7  http://purl.obolibrary.org/obo/VTO_0052708   Marukawichthys ambulator
#&gt; 8  http://purl.obolibrary.org/obo/VTO_0035095     Pseudobagrus tokiensis
#&gt; 9  http://purl.obolibrary.org/obo/VTO_0052614 Rhamphocottus richardsonii
#&gt; 10 http://purl.obolibrary.org/obo/VTO_0034991               Siluriformes
#&gt; 11 http://purl.obolibrary.org/obo/VTO_0036124             Silurus glanis</div><div class='input'>
<span class='co'># can also coerce entire list at once</span>
<span class='va'>objs</span> <span class='op'>&lt;-</span> <span class='fu'>as.phenotype</span><span class='op'>(</span><span class='va'>phens</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>objs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "list"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>objs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 20</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>objs</span>, <span class='va'>is.phenotype</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>objs</span><span class='op'>[[</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; Phenotype 'basihyal bone absent'
#&gt; Linked to states:
#&gt;                label character.label           study.label
#&gt; 1  states 0, 1 and 2        Basihyal Imamura et al. (2005)
#&gt; 2 absent (unordered)        Basihyal Imamura et al. (2005)
#&gt; 3             Absent   Basihyal bone  Mabee et al.  (2011)
#&gt; 4    basihyal absent        Basihyal       De Pinna (1993)
#&gt; 
#&gt; Entities:
#&gt;     multicellular organism &lt;http://purl.obolibrary.org/obo/UBERON_0000468&gt;
#&gt; Qualities:
#&gt;     lacks all parts of type &lt;http://purl.obolibrary.org/obo/PATO_0002000&gt;
#&gt; Towards:
#&gt;     basihyal bone &lt;http://purl.obolibrary.org/obo/UBERON_0011618&gt;
#&gt; 
#&gt; No information about taxa exhibiting this phenotype.</div><div class='input'>
<span class='co'># extract character states and (non-redundant) characters</span>
<span class='fu'>charstates</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                                                     id
#&gt; 1 http://purl.org/phenoscape/uuid/62b5a920-8b49-42be-86f9-baab28a601fc
#&gt; 2 http://purl.org/phenoscape/uuid/eb9a3385-bd7f-46a8-ac8f-ac109e8e0e3c
#&gt; 3 http://purl.org/phenoscape/uuid/78fa240f-904b-4018-89e9-07c1550539fc
#&gt; 4 http://purl.org/phenoscape/uuid/5b7b3d47-890a-4bf7-be90-61417c3d1bf3
#&gt;                label
#&gt; 1  states 0, 1 and 2
#&gt; 2 absent (unordered)
#&gt; 3             Absent
#&gt; 4    basihyal absent
#&gt;                                                           character.id
#&gt; 1 http://purl.org/phenoscape/uuid/44a9193e-4da7-45ba-9eae-6ca060579da2
#&gt; 2 http://purl.org/phenoscape/uuid/44a9193e-4da7-45ba-9eae-6ca060579da2
#&gt; 3 http://purl.org/phenoscape/uuid/46cd66db-2454-4304-bf12-9a63aa7421ba
#&gt; 4 http://purl.org/phenoscape/uuid/cedb8568-c69e-45b1-907c-d9a0bc677f6e
#&gt;   character.label                                    study.id
#&gt; 1        Basihyal http://dx.doi.org/10.1007/s10228-005-0282-6
#&gt; 2        Basihyal http://dx.doi.org/10.1007/s10228-005-0282-6
#&gt; 3   Basihyal bone http://dx.doi.org/10.11646/zootaxa.2877.1.1
#&gt; 4        Basihyal      https://ci.nii.ac.jp/naid/10012505149/
#&gt;             study.label
#&gt; 1 Imamura et al. (2005)
#&gt; 2 Imamura et al. (2005)
#&gt; 3  Mabee et al.  (2011)
#&gt; 4       De Pinna (1993)</div><div class='input'><span class='fu'>chars</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                                           character.id
#&gt; 1 http://purl.org/phenoscape/uuid/44a9193e-4da7-45ba-9eae-6ca060579da2
#&gt; 3 http://purl.org/phenoscape/uuid/46cd66db-2454-4304-bf12-9a63aa7421ba
#&gt; 4 http://purl.org/phenoscape/uuid/cedb8568-c69e-45b1-907c-d9a0bc677f6e
#&gt;   character.label                                    study.id
#&gt; 1        Basihyal http://dx.doi.org/10.1007/s10228-005-0282-6
#&gt; 3   Basihyal bone http://dx.doi.org/10.11646/zootaxa.2877.1.1
#&gt; 4        Basihyal      https://ci.nii.ac.jp/naid/10012505149/
#&gt;             study.label
#&gt; 1 Imamura et al. (2005)
#&gt; 3  Mabee et al.  (2011)
#&gt; 4       De Pinna (1993)</div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># IDs that don't resolve still yield an object, but is not valid</span>
<span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'>as.phenotype</span><span class='op'>(</span><span class='st'>"http://foo"</span><span class='op'>)</span>
<span class='fu'>is.phenotype</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
<span class='fu'>is_valid_phenotype</span><span class='op'>(</span><span class='va'>obj</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


