<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Obtains term frequencies for the Phenoscape KB — term_freqs • rphenoscape</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Obtains term frequencies for the Phenoscape KB — term_freqs"><meta property="og:description" content="Determines the frequencies for the given input list of terms, based on
the selected corpus and the type (category) of the terms."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rphenoscape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/rphenoscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/phenoscape/rphenoscape/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Obtains term frequencies for the Phenoscape KB</h1>
    <small class="dont-index">Source: <a href="https://github.com/phenoscape/rphenoscape/blob/HEAD/R/term-weights.R" class="external-link"><code>R/term-weights.R</code></a></small>
    <div class="hidden name"><code>term_freqs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Determines the frequencies for the given input list of terms, based on
the selected corpus and the type (category) of the terms.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">term_freqs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  as <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"phenotype"</span>, <span class="st">"entity"</span>, <span class="st">"anatomical_entity"</span>, <span class="st">"quality"</span><span class="op">)</span>,</span>
<span>  corpus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon-variation"</span>, <span class="st">"annotated-taxa"</span>, <span class="st">"taxon-annotations"</span>, <span class="st">"states"</span>,</span>
<span>    <span class="st">"gene-annotations"</span>, <span class="st">"genes"</span><span class="op">)</span>,</span>
<span>  decodeIRI <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a vector or list of one or more terms, either as IRIs or as term
objects.</p></dd>


<dt>as</dt>
<dd><p>the category or categories (a.k.a. type) of the input terms (see <code><a href="term_category.html">term_category()</a></code>).
Possible values are "anatomical_entity" (synonymous with "entity"), "quality", and
"phenotype". Unambiguous abbreviations are acceptable. The value must either be a
single category (applying to all terms), or a vector of categories (of same length as <code>x</code>).
The default is "phenotype".</p>
<p>Note that at present, support by the KB API for "quality" remains pending and has thus been
disabled as of v0.3.0. Also, mixing different categories of terms is not yet supported, and
doing so will thus raise an error.</p></dd>


<dt>corpus</dt>
<dd><p>the name of the corpus for determining how to count, currently one of the following:</p><ul><li><p>"states" (counts character states),</p></li>
<li><p>"taxon-variation" (counts taxa with variation profiles, and thus does not include terminal
and other taxa that do not have child taxa with phenotype annotations),</p></li>
<li><p>"annotated-taxa" (counts taxa with phenotype annotations, and thus primarily those terminal
taxa that have annotations),</p></li>
<li><p>"taxon-annotations" (counts phenotype annotations to character states and thus taxa),</p></li>
<li><p>"gene-annotations" (counts phenotype annotations to genes or alleles), and</p></li>
<li><p>"genes" (counts genes)</p></li>
</ul><p>Unambiguous abbreviations of corpus names are acceptable. The default is "taxon-variation".
Note that at present "taxon-annotations" and "gene-annotations" are not yet
supported by the KB API and will thus result in an error.</p>
<p>Note that previously "taxa" was allowed as a corpus, but is no longer supported.
The "taxon-variation" corpus is the equivalent of the deprecated "taxa" corpus.</p></dd>


<dt>decodeIRI</dt>
<dd><p>boolean. This parameter is deprecated (as of v0.3.x) and must be set
to FALSE (the default). If TRUE is passed an error will be raised. In v0.2.x
when TRUE this parameter would attempt to decode post-composed entity IRIs.
Due to changes in the IRI returned by the Phenoscape KB v2.x API decoding
post-composed entity IRIs is no longer possible. Prior to v0.3.x, the default
value for this parameter was TRUE.</p></dd>


<dt>...</dt>
<dd><p>additional query parameters to be passed to the function querying
for counts, see <code><a href="pkb_args_to_query.html">pkb_args_to_query()</a></code>. This is currently (as of v0.3.0) not
used.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a vector of frequencies as floating point numbers (between zero
and 1.0), of the same length (and ordering) as the input list of terms.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Depending on the corpus selected, the frequencies are queried directly
from pre-computed counts through the KB API, or are calculated based on
matching row counts obtained from query results. Currently, the Phenoscape KB
has precomputed counts for corpora "annotated-taxa","taxon-variation", "states", and "genes".</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Term categories being accurate is vital for obtaining correct counts and
thus frequencies. In earlier (&lt;=0.2.x) releases, auto-determining term
category was an option, but this is no longer supported, in part because it
was potentially time consuming and often inaccurate, in particular for
the many post-composed subsumer terms returned by <code><a href="subsumer_matrix.html">subsumer_matrix()</a></code>. In the
KB v2.0 API, auto-determining the category of a post-composed term is no
longer supported. If the list of terms is legitimately of different categories,
determine (and possibly correct) categories beforehand using <code><a href="term_category.html">term_category()</a></code>.</p>
<p>In earlier (&lt;=0.2.x) releases one supported corpus was "taxon_annotations", albeit
its implementation was very slow and potentially inaccurate because it relied on
potentially multiple individudal KB API queries for each term, and this in turn
relied on the ability to break down post-composed expressions into their component
terms and expressions, which is (at least currently) no longer possible.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">phens</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_phenotypes.html">get_phenotypes</a></span><span class="op">(</span>entity <span class="op">=</span> <span class="st">"basihyal bone"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># see which phenotypes we have:</span></span></span>
<span class="r-in"><span><span class="va">phens</span><span class="op">$</span><span class="va">label</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "anatomical projection and (part_of some (posterior margin and (part_of some basihyal bone))) absent" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "anatomical projection and (part_of some (posterior margin and (part_of some basihyal bone))) present"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "anterior margin and (part_of some basihyal bone) straight"                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "anterior region and (part_of some basihyal bone) increased size"                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "anterior region and (part_of some basihyal bone) increased width"                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "basibranchial 1 bone position basihyal bone"                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "basibranchial 2 bone interlocked with basihyal bone"                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "basihyal bone absent"                                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "basihyal bone bifurcated"                                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "basihyal bone cylindrical"                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "basihyal bone decreased length"                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "basihyal bone elongated"                                                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "basihyal bone horizontal"                                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "basihyal bone increased length"                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "basihyal bone increased size"                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "basihyal bone oblique orientation"                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "basihyal bone present"                                                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "basihyal bone right angle to basibranchial 1 element"                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "basihyal bone shape"                                                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "basihyal bone shape and (not (Y-shaped))"                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "basihyal bone size"                                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "basihyal bone T-shaped"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "basihyal bone tightly articulated with basibranchial 1 bone"                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "basihyal bone triangular"                                                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "basihyal bone Y-shaped"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "bone fossa and (part_of some basihyal bone) absent"                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "bone fossa and (part_of some basihyal bone) size"                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "bone fossa and (part_of some basihyal bone) size"                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "dorsal surface and (part_of some basihyal bone) circular"                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30] "dorsal surface and (part_of some basihyal bone) concave"                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "dorsal surface and (part_of some basihyal bone) convex"                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32] "dorsal surface and (part_of some basihyal bone) convex"                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "dorsal surface and (part_of some basihyal bone) flat"                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34] "dorsal surface and (part_of some basihyal bone) flat"                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35] "parasphenoid structure basihyal bone"                                                                </span>
<span class="r-in"><span><span class="co"># frequencies by counting taxa:</span></span></span>
<span class="r-in"><span><span class="va">freqs.t</span> <span class="op">&lt;-</span> <span class="fu">term_freqs</span><span class="op">(</span><span class="va">phens</span><span class="op">$</span><span class="va">id</span>, as <span class="op">=</span> <span class="st">"phenotype"</span>, corpus <span class="op">=</span> <span class="st">"taxon-variation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">freqs.t</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.005012531 0.005012531 0.002506266 0.000000000 0.000000000 0.002506266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.000000000 0.002506266 0.002506266 0.002506266 0.001253133 0.001253133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.002506266 0.001253133 0.001253133 0.002506266 0.005012531 0.002506266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] 0.006265664 0.001253133 0.002506266 0.002506266 0.000000000 0.003759398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 0.001253133 0.001253133 0.001253133 0.001253133 0.001253133 0.001253133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 0.001253133 0.001253133 0.001253133 0.001253133 0.001253133</span>
<span class="r-in"><span><span class="co"># we can convert this to absolute counts:</span></span></span>
<span class="r-in"><span><span class="va">freqs.t</span> <span class="op">*</span> <span class="fu"><a href="corpus_size.html">corpus_size</a></span><span class="op">(</span><span class="st">"taxon-variation"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 4 4 2 0 0 2 0 2 2 2 1 1 2 1 1 2 4 2 5 1 2 2 0 3 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="co"># frequencies by counting character states:</span></span></span>
<span class="r-in"><span><span class="va">freqs.s</span> <span class="op">&lt;-</span> <span class="fu">term_freqs</span><span class="op">(</span><span class="va">phens</span><span class="op">$</span><span class="va">id</span>, as <span class="op">=</span> <span class="st">"phenotype"</span>, corpus <span class="op">=</span> <span class="st">"states"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">freqs.s</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000351358 0.0000351358 0.0000351358 0.0000351358 0.0000351358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 0.0000702716 0.0000351358 0.0001405432 0.0000351358 0.0000351358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 0.0000351358 0.0000351358 0.0000351358 0.0000351358 0.0000702716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 0.0000351358 0.0004567654 0.0000351358 0.0003162222 0.0000351358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] 0.0001756790 0.0000351358 0.0000351358 0.0001054074 0.0000702716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] 0.0000351358 0.0000351358 0.0000351358 0.0000351358 0.0000351358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 0.0000351358 0.0000351358 0.0000351358 0.0000351358 0.0000702716</span>
<span class="r-in"><span><span class="co"># and as absolute counts:</span></span></span>
<span class="r-in"><span><span class="va">freqs.s</span> <span class="op">*</span> <span class="fu"><a href="corpus_size.html">corpus_size</a></span><span class="op">(</span><span class="st">"states"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  1  1  1  1  2  1  4  1  1  1  1  1  1  2  1 13  1  9  1  5  1  1  3  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  1  1  1  1  1  1  1  1  1  2</span>
<span class="r-in"><span><span class="co"># we can compare the absolute counts by computing a ratio</span></span></span>
<span class="r-in"><span><span class="va">freqs.s</span> <span class="op">*</span> <span class="fu"><a href="corpus_size.html">corpus_size</a></span><span class="op">(</span><span class="st">"states"</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">freqs.t</span> <span class="op">*</span> <span class="fu"><a href="corpus_size.html">corpus_size</a></span><span class="op">(</span><span class="st">"taxon-variation"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.25 0.25 0.50  Inf  Inf 1.00  Inf 2.00 0.50 0.50 1.00 1.00 0.50 1.00 2.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 0.50 3.25 0.50 1.80 1.00 2.50 0.50  Inf 1.00 2.00 1.00 1.00 1.00 1.00 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] 1.00 1.00 1.00 1.00 2.00</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Xu, Hilmar Lapp, John Bradley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

